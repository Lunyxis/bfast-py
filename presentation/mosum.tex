\documentclass[presentation.tex]{subfiles}

\begin{document}

\begin{frame}
\frametitle{OLS-MOSUM Test - The Model}
\begin{itemize}
  \item One step of the BFAST algorithm is to detect structural change in the
    trend and seasonal components before we commit to the heavy-weight
    estimation of the number and location of the breakpoints.
  \item For each observation $i \in (1, \ldots, n)$ we consider a following linear model:
    \[
    y_{i}=x_{i}^{\top} \beta_{i}+u_{i}
    \]
    where:
    \begin{itemize}
    \item $x_i = (1,x_{i2}, x_{i3}, ..., x_{ik})^T \in \mathbb{R}^k$
    \item $u_i \in \mathbb{R}$ is the residual term that is independently and identically
      distributed with mean $\mu = 0$ and variance $\sigma^2$.
    \end{itemize}
  \item 
    We can then test for structural change by testing the null hypothesis:
    \[
    H_0:\quad \beta_i = \beta_0 \quad(i=1, \ldots, n)
    \]
\end{itemize}
\end{frame}

\begin{frame}
  \frametitle{OLS-MOSUM Test - Continued}
  \begin{itemize}
  \item $\hat{\beta}^{(n)}$ is the ordinary least squares (OLS) estimate of the
    regression coefficients based on all the observations up to $n$,
  \item 
    Let the OLS residuals (estimates of $u_i$) be defined as:
    \begin{equation} \label{eq:residuals}
      \hat{u}_i = y_i - x_i^T\hat{\beta}^{(n)}
    \end{equation}
    the variance estimate would then be:
    \begin{equation} \label{eq:sigma}
      \hat{\sigma}^{2}=\frac{1}{n-k} \sum_{i=1}^{n} \hat{u}_{i}^{2}
    \end{equation}
  \end{itemize} 
\end{frame}

\begin{frame}
  \frametitle{Empirical Fluctuation Process (OLS-MOSUM)}
  \begin{itemize}
  \item It is possible to detect structural change by analyzing moving sum of residuals ($\hat{u}$)
  \item 
    The resulting empirical fluctuation process consists of a
    sum of a fixed number of residuals in a data interval, which size is determined
    by the value of the parameter $h \in (0,1)$ (bandwidth).
  \item 
  The OLS-based MOSUM process at time $t$ is given by:
  \begin{equation}\label{eq:mosum_og}
    M(t)=\frac{1}{\hat{\sigma} \sqrt{n}}
    \left(\sum_{i=\floor{N_{n} t}+1}^{\left\lfloor N_{n} t\right\rfloor+\lfloor
      n h\rfloor} \hat{u}_{i}\right) \quad(0 \leq t \leq 1-h)
  \end{equation}
  where $N_{n}=(n-\floor{n h}) /(1-h)$ and $\floor{n h}$ is the size of the
  window. 
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Significance Testing}
  \begin{itemize}
  \item 
    A key observation is that if a structural change takes place at $t_0$, the
    OLS-MOSUM path would also have a strong shift at $t_0$.
    We reject the null hypothesis of there being no structural change, when the fluctuation of
    the OLS-MOSUM process becomes too large.
  \item
    In practice, we determine whether the null
    hypothesis can be rejected using a significance test (also called statistical
    hypothesis testing).
  \item 
    First, we calculate the test statistic. For the residual-based OLS-MOSUM
    process, it is defined as:
    \begin{equation} \label{eq:test_statistic_og}
      S_{\text{MOSUM}} = \max(|M(t)|) \quad \text{ for } 0 \leq t \leq (1-h)
    \end{equation}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Significance Testing - Continued}
  \begin{itemize}
  \item This formulation is not usable in a context of an implementation, since we are working
    with infinite set of real numbers from $0$ to $1-h$.
  \item Another key observation is that $M(t)$ returns $n - \floor{nh} + 1$ unique values for $0 \leq t \leq (1-h)$:
  \item Let:
    \begin{equation} \label{eq:mosum}
      \bar{M}(t') =
      \frac{1}{\hat{\sigma} \sqrt{n}}
      \left(\sum_{i=t}^{t' + \floor{nh}} \hat{u}_i\right)
      \quad(t' = 1,2, \hdots, n - \floor{nh} + 1))
    \end{equation}
  \item Then: 
    $\max(|M(t)|) = \max(|\bar{M}(t')|)$ and we have:
    \begin{equation} \label{eq:test_statistic}
      S_{\text{MOSUM}} = \max(|\bar{M}(t')|) \quad \text{ for } t' \text{ in } 1,2,..,(n - \floor{nh} + 1)
    \end{equation}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Significance Testing - Continued 2}
  \begin{itemize}
  \item We use the value of $S_{\text{MOSUM}}$ to calculate the probability of getting such
    sample, given that the null hypothesis holds, using the critical values approach.
    The p-value is calculated from the table of
    simulated asymptotic critical values of the Moving Estimate (ME) tests with
    the maximum norm, given by Chu et al. (1995).
  \item  We then compare the resulting
    probability with a chosen confidence interval, which is a value $0 < \alpha < 1$
    \item If the resulting probability is below the
      value of $\alpha$, we reject the null hypothesis, hence a 
      structural change is detected in the time series. 
  \end{itemize}
\end{frame}

%% \begin{frame}[fragile]
%%   \frametitle{Table of Critical Values}
%%   \begin{table}[]
%%     \centering
%% \begin{tabular}{|l|l|l|l|l|l|}
%% \hline
%% \multirow{2}{*}{$k$}      & \multicolumn{1}{c|}{\multirow{2}{*}{h}} & \multicolumn{4}{c|}{Tail probability}                                                                     \\ \cline{3-6} 
%%                           & \multicolumn{1}{c|}{}                   & 0.10                     & 0.05                     & 0.025                    & 0.01                     \\ \hline
%% \multirow{4}{*}{1}        & 0.05                                    & 0.7552                   & 0.8017                   & 0.8444                   & 0.8977                   \\ \cline{2-6} 
%%                           & 0.10                                    & 0.9809                   & 1.0483                   & 1.1119                   & 1.1888                   \\ \cline{2-6} 
%%                           & \multicolumn{1}{c|}{...}                & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} \\ \cline{2-6} 
%%                           & 0.50                                    & 1.3560                   & 1.4938                   & 1.6166                   & 1.7663                   \\ \hline
%% \multirow{4}{*}{2}        & 0.05                                    & 0.7997                   & 0.8431                   & 0.8838                   & 0.9351                   \\ \cline{2-6} 
%%                           & 0.10                                    & 1.0448                   & 1.1067                   & 1.1634                   & 1.2388                   \\ \cline{2-6} 
%%                           & \multicolumn{1}{c|}{...}                & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} \\ \cline{2-6} 
%%                           & 0.50                                    & 1.4884                   & 1.6125                   & 1.7266                   & 1.8639                   \\ \hline
%% \multicolumn{1}{|c|}{...} & \multicolumn{1}{c|}{...}                & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} & \multicolumn{1}{c|}{...} \\ \hline
%% \end{tabular}
%% \caption{An excerpt from the table of simulated asymptotic critical values of the
%%   ME tests with the maximum norm}
%% \label{table:critvals}
%% \end{table}
%% \end{frame}


\begin{frame}[fragile]
  \frametitle{OLS-MOSUM Test - Steps of the Algorithm}
  \begin{enumerate}
  \item \textbf{Calculate $\hat{\beta}^{(n)}$ using OLS-based linear
    regression from matrix $\mathrm{X}$ and vector $y$}
  \item \textbf{Calculate the vector of OLS residuals $\hat{\mu}$}
  \item \textbf{Calculate the standard deviation $\hat{\sigma}$}
  \item \textbf{Calculate the residual-based OLS-MOSUM process as a vector of size $n - \floor{nh} + 1$}
  \begin{verbatim}
  nh = floor(n * h)
  e = concat([0], residuals)
  process = cumsum(e)
  process = process[nh:n] - process[0:(n - nh + 1)]
  process = process / (sigma * sqrt(n))
  \end{verbatim}
\item \textbf{Calculate the test statistic $S_{\text{test}}$} = \texttt{max(abs(process))}
\item \textbf{Calculate the p-value using the table of critical values and linear interpolation}
\item \textbf{Return the result}: \\
  If $p \leq \alpha$, we reject the null-hypothesis. Structural change is detected
  \end{enumerate} 
\end{frame}




\end{document}
