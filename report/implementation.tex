\documentclass[main.tex]{subfiles}

\begin{document}
\chapter{Implementation}
\label{chap:implementation}
Both BFAST0n and BFAST algorithms were implemented in Python 3.8.3 using
\texttt{numpy}, \texttt{statsmodels}\cite{statsmodels} for all the computation
and \texttt{matplotlib} for all the plotting. The implementation is based on the
original R implementation of BFAST and BFAST0n by Verbesselt et al.
\cite{bfast-github} and the \texttt{strucchange} library by Zeileis
\cite{strucchange_code}.


\section{Linear Regression}
\label{sec:linear_regression}
Linear regression is the cornerstone of BFAST and all its components such as
OLS-MOSUM test and the breakpoint estimation algorithm. Therefore it is
essential to choose a suitable implementation for this operation. There exist a
plethora of linear regression implementations for Python, but I have decided to
use the \texttt{statsmodels.regression.linear\_model.OLS} function from the
\texttt{statsmodels} library \cite{statsmodels}. It was chosen for its
stability, flexibility and detailed documentation.

\section{STL}
\label{sec:impl_stl}
For the STL decomposition algorithm, I have chosen the \texttt{tsa.seasonal.STL} function
from the \texttt{statsmodels} library. Source file \texttt{stl.py} includes a
wrapper around the \texttt{STL} method that also replaces the missing values
(NaNs) with interpolated values. It also includes a function 
\texttt{seasonal\_average} that emulates the functionality of
setting the $n_s$ parameter to ``periodic'' by taking the seasonal average of
the seasonal component of the decomposition, since \texttt{statsmodels}
implementation does not have a support for this option. For more information
about the STL parameters, please refer to Chapter \ref{chap:stl}.

\section{OLS-MOSUM Test}
\label{sec:impl_mosum}


\section{Breakpoint Estimation}
\label{sec:impl_breakpoints}

\section{BFAST0n}
\label{sec:impl_bfast0n}
The implementation of BFAST0n is very straight-forward and follows the
guidelines, outlined in Chpater \ref{chap:bfast0n}.

\section{BFAST}
\label{sec:bfast}

\biblio
\end{document}
